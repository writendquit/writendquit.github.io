---
import PageHead from '@/components/PageHead.astro'
import Layout from '@/layouts/Layout.astro'
import { Icon } from 'astro-icon/components'
import Link from '@/components/Link.astro'
import CTFRatingChart from '@/components/CTFRatingChart'

const teamStats = {
  name: '.;,;.',
  rank: '#42',
  country: 'US',
  points: 1847.5,
  ctfsPlayed: 67,
}

const recentCTFs = [
  {
    name: 'DEFCON CTF 2024',
    position: 15,
    totalTeams: 420,
    points: 2450,
    date: '2024-08-10',
  },
  {
    name: 'Google CTF 2024',
    position: 8,
    totalTeams: 890,
    points: 1850,
    date: '2024-06-22',
  },
  {
    name: 'PlaidCTF 2024',
    position: 23,
    totalTeams: 550,
    points: 1200,
    date: '2024-04-14',
  },
  {
    name: 'picoCTF 2024',
    position: 3,
    totalTeams: 6800,
    points: 9800,
    date: '2024-03-26',
  },
]

const upcomingCTFs = [
  {
    name: 'Hack.lu CTF 2024',
    date: 'Oct 18-20',
    weight: 77.5,
  },
  {
    name: 'Dragon CTF 2024',
    date: 'Nov 23-24',
    weight: 99.0,
  },
  {
    name: 'hxp CTF 2024',
    date: 'Dec 6-8',
    weight: 95.0,
  },
]
---

<Layout class="max-w-5xl">
  <PageHead slot="head" title="CTFs" />
  
  <div class="mb-8">
    <h1 class="text-3xl font-bold tracking-tight">CTF History</h1>
    <p class="text-muted-foreground">Competition results and rankings</p>
  </div>

  <div class="mb-10 grid gap-6 md:grid-cols-3">
    <div class="rounded-xl border p-6">
      <p class="text-sm text-muted-foreground">Global Rank</p>
      <p class="text-4xl font-bold">{teamStats.rank}</p>
    </div>
    <div class="rounded-xl border p-6">
      <p class="text-sm text-muted-foreground">Rating Points</p>
      <p class="text-4xl font-bold">{teamStats.points}</p>
    </div>
    <div class="rounded-xl border p-6">
      <p class="text-sm text-muted-foreground">CTFs Played</p>
      <p class="text-4xl font-bold">{teamStats.ctfsPlayed}</p>
    </div>
  </div>

  <section class="mb-10">
    <h2 class="mb-4 text-lg font-semibold">Rating Over Time</h2>
    <div class="rounded-xl border p-6">
      <CTFRatingChart client:load />
    </div>
  </section>

  <div class="mb-10 grid gap-6 lg:grid-cols-2">
    <section>
      <h2 class="mb-4 text-lg font-semibold">Recent Results</h2>
      <div class="space-y-3">
        {recentCTFs.map((ctf) => (
          <div class="rounded-xl border p-4 transition-colors hover:bg-muted/50">
            <div class="flex items-center justify-between">
              <div>
                <h3 class="font-medium">{ctf.name}</h3>
                <p class="text-sm text-muted-foreground">{ctf.date}</p>
              </div>
              <div class="text-right">
                <p class="text-xl font-bold">#{ctf.position}</p>
                <p class="text-xs text-muted-foreground">of {ctf.totalTeams}</p>
              </div>
            </div>
          </div>
        ))}
      </div>
    </section>

    <section>
      <h2 class="mb-4 text-lg font-semibold">Upcoming CTFs</h2>
      <div class="space-y-3">
        {upcomingCTFs.map((ctf) => (
          <div class="rounded-xl border p-4 transition-colors hover:bg-muted/50">
            <div class="flex items-center justify-between">
              <div>
                <h3 class="font-medium">{ctf.name}</h3>
                <p class="text-sm text-muted-foreground">{ctf.date}</p>
              </div>
              <span class="rounded-full bg-muted px-3 py-1 text-sm font-medium">
                {ctf.weight} pts
              </span>
            </div>
          </div>
        ))}
      </div>
      
      <Link 
        href="https://ctftime.org/event/list/upcoming" 
        external 
        class="mt-4 flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors"
      >
        View all on CTFtime
        <Icon name="lucide:arrow-right" class="size-4" />
      </Link>
    </section>
  </div>

  <section class="mb-10">
    <h2 class="mb-4 text-lg font-semibold">Writeups</h2>
    <div class="grid gap-4 sm:grid-cols-3">
      <Link href="/blog?tag=pwn" class="group rounded-xl border p-5 transition-colors hover:bg-muted/50">
        <h3 class="mb-1 font-medium group-hover:underline">PWN</h3>
        <p class="text-sm text-muted-foreground">Binary exploitation</p>
      </Link>
      <Link href="/blog?tag=crypto" class="group rounded-xl border p-5 transition-colors hover:bg-muted/50">
        <h3 class="mb-1 font-medium group-hover:underline">Crypto</h3>
        <p class="text-sm text-muted-foreground">Cryptography</p>
      </Link>
      <Link href="/blog?tag=web" class="group rounded-xl border p-5 transition-colors hover:bg-muted/50">
        <h3 class="mb-1 font-medium group-hover:underline">Web</h3>
        <p class="text-sm text-muted-foreground">Web security</p>
      </Link>
    </div>
  </section>

  <footer class="border-t pt-8">
    <div class="flex items-center justify-center gap-6">
      <Link 
        href="https://ctftime.org" 
        external 
        class="flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors"
      >
        <Icon name="lucide:flag" class="size-5" />
        <span class="text-sm">CTFtime</span>
      </Link>
      <Link 
        href="https://github.com/writendquit" 
        external 
        class="flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors"
      >
        <Icon name="lucide:github" class="size-5" />
        <span class="text-sm">GitHub</span>
      </Link>
      <Link 
        href="https://twitter.com/writendquit" 
        external 
        class="flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors"
      >
        <Icon name="lucide:twitter" class="size-5" />
        <span class="text-sm">Twitter</span>
      </Link>
    </div>
  </footer>
</Layout>
