---
interface Props {
  class?: string
  size?: number
}

const { class: className, size = 64 } = Astro.props
---

<div class:list={["ctf-flag-container", className]}>
  <svg 
    viewBox="0 0 80 80" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg"
    width={size}
    height={size}
    class="ctf-flag"
  >
    <!-- Flag pole with gradient -->
    <defs>
      <linearGradient id="poleGrad" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" style="stop-color:#1a1a1a"/>
        <stop offset="50%" style="stop-color:#333"/>
        <stop offset="100%" style="stop-color:#1a1a1a"/>
      </linearGradient>
      <linearGradient id="flagGrad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#3B9FD8"/>
        <stop offset="50%" style="stop-color:#5CB8E8"/>
        <stop offset="100%" style="stop-color:#2A8BC4"/>
      </linearGradient>
      <filter id="glow">
        <feGaussianBlur stdDeviation="1" result="coloredBlur"/>
        <feMerge>
          <feMergeNode in="coloredBlur"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    
    <!-- Pole -->
    <rect x="10" y="8" width="5" height="64" rx="2.5" fill="url(#poleGrad)"/>
    
    <!-- Pole top ball -->
    <circle cx="12.5" cy="10" r="4" fill="#000"/>
    <circle cx="11" cy="8.5" r="1" fill="#444"/>
    
    <!-- Flag waving shape -->
    <path 
      class="flag-wave"
      d="M15 12 
         Q35 6 55 14 
         Q62 22 58 32 
         Q65 40 55 48
         Q35 54 15 46 
         Z" 
      fill="url(#flagGrad)"
    />
    
    <!-- Cloud accents (from your goggle reflections) -->
    <ellipse cx="38" cy="24" rx="10" ry="5" fill="rgba(255,255,255,0.5)" class="cloud cloud-1"/>
    <ellipse cx="46" cy="22" rx="6" ry="3" fill="rgba(255,255,255,0.3)" class="cloud cloud-2"/>
    <ellipse cx="32" cy="38" rx="8" ry="4" fill="rgba(255,255,255,0.4)" class="cloud cloud-3"/>
    
    <!-- Goggle-style circles (signature from your pfp) -->
    <g filter="url(#glow)">
      <circle cx="30" cy="30" r="8" fill="none" stroke="#000" stroke-width="2"/>
      <circle cx="30" cy="30" r="6" fill="#5CB8E8"/>
      <ellipse cx="28" cy="28" rx="2" ry="1.5" fill="rgba(255,255,255,0.6)"/>
    </g>
    
    <g filter="url(#glow)">
      <circle cx="48" cy="32" r="7" fill="none" stroke="#000" stroke-width="2"/>
      <circle cx="48" cy="32" r="5" fill="#5CB8E8"/>
      <ellipse cx="46" cy="30" rx="1.5" ry="1" fill="rgba(255,255,255,0.6)"/>
    </g>
    
    <!-- :wq! branding -->
    <text x="34" y="46" font-family="monospace" font-size="7" font-weight="bold" fill="#000" class="flag-text">:wq!</text>
    
    <!-- Flag ribbons at bottom -->
    <path d="M15 46 L15 52 Q25 50 35 53 L35 47" fill="#2A8BC4" opacity="0.8"/>
    <path d="M35 47 L35 53 Q45 50 55 52 L55 48" fill="#1E7AAD" opacity="0.8"/>
  </svg>
</div>

<style>
  .ctf-flag-container {
    display: inline-block;
  }
  
  .ctf-flag {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
  }
  
  .flag-wave {
    animation: wave 3s ease-in-out infinite;
    transform-origin: left center;
  }
  
  .cloud {
    animation: float 4s ease-in-out infinite;
  }
  
  .cloud-1 { animation-delay: 0s; }
  .cloud-2 { animation-delay: 1s; }
  .cloud-3 { animation-delay: 2s; }
  
  .flag-text {
    animation: pulse 2s ease-in-out infinite;
  }
  
  @keyframes wave {
    0%, 100% { 
      d: path("M15 12 Q35 6 55 14 Q62 22 58 32 Q65 40 55 48 Q35 54 15 46 Z"); 
    }
    50% { 
      d: path("M15 12 Q40 10 55 16 Q60 24 56 34 Q62 42 55 48 Q38 52 15 46 Z"); 
    }
  }
  
  @keyframes float {
    0%, 100% { transform: translateX(0); opacity: 0.5; }
    50% { transform: translateX(3px); opacity: 0.3; }
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }
</style>
