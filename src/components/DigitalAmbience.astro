---
// Digital Ambience - Minecraft butterfly that feeds on RAM/cookies + Matrix rain idle effect
---

<!-- Floating Clouds Container (Left Side) -->
<div id="clouds-container" class="fixed left-0 top-1/4 z-40 pointer-events-none">
  <!-- Cloud 1 - UTC Time -->
  <div class="cloud cloud-1 opacity-0" style="transform: translateX(-100%);">
    <div class="cloud-glass">
      <div class="cloud-shape"></div>
      <div class="cloud-content">
        <div class="cloud-label">UTC TIME</div>
        <div id="utc-time" class="cloud-value font-mono">--:--:--</div>
        <div id="utc-date" class="cloud-date">----/--/--</div>
      </div>
    </div>
  </div>
  
  <!-- Cloud 2 - Local Time -->
  <div class="cloud cloud-2 opacity-0" style="transform: translateX(-100%);">
    <div class="cloud-glass">
      <div class="cloud-shape"></div>
      <div class="cloud-content">
        <div class="cloud-label">LOCAL TIME</div>
        <div id="local-time" class="cloud-value font-mono">--:--:--</div>
        <div id="local-zone" class="cloud-date">Timezone</div>
      </div>
    </div>
  </div>
  
  <!-- Cloud 3 - Status -->
  <div class="cloud cloud-3 opacity-0" style="transform: translateX(-100%);">
    <div class="cloud-glass">
      <div class="cloud-shape"></div>
      <div class="cloud-content">
        <div class="cloud-label">STATUS</div>
        <div class="cloud-status">
          <span class="status-dot"></span>
          <span id="connection-status">Online</span>
        </div>
        <div id="uptime" class="cloud-date">Session: 0s</div>
      </div>
    </div>
  </div>
</div>

<!-- Single Minecraft-Style Pixel Butterfly -->
<div id="minecraft-butterfly" class="fixed z-40 pointer-events-none" style="bottom: 100px; right: 100px;">
  <div class="mc-butterfly">
    <!-- Left Wing with Data -->
    <div class="mc-wing mc-wing-left">
      <div class="wing-pixels">
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-3);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
      </div>
      <!-- Data overlay on wing -->
      <div class="wing-data-overlay">
        <span id="mc-browser" class="mc-data">--</span>
        <span id="mc-screen" class="mc-data">--</span>
      </div>
    </div>
    
    <!-- Body (Pixelated) -->
    <div class="mc-body">
      <div class="body-pixel"></div>
      <div class="body-pixel"></div>
      <div class="body-pixel"></div>
      <div class="body-pixel head"></div>
      <!-- Antennae -->
      <div class="mc-antenna mc-antenna-left"></div>
      <div class="mc-antenna mc-antenna-right"></div>
    </div>
    
    <!-- Right Wing with Data -->
    <div class="mc-wing mc-wing-right">
      <div class="wing-pixels">
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-3);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
          <div class="pixel" style="background: var(--wing-color-2);"></div>
        </div>
        <div class="pixel-row">
          <div class="pixel" style="background: var(--wing-color-2);"></div>
          <div class="pixel" style="background: var(--wing-color-1);"></div>
        </div>
      </div>
      <!-- Data overlay on wing -->
      <div class="wing-data-overlay">
        <span id="mc-os" class="mc-data">--</span>
        <span id="mc-visitors" class="mc-data">--</span>
      </div>
    </div>
  </div>
  
  <!-- Tooltip that follows butterfly -->
  <div id="butterfly-tooltip" class="mc-tooltip">
    <div class="tooltip-header">Digital Butterfly</div>
    <div class="tooltip-row"><span class="tooltip-label">Browser:</span> <span id="tip-browser">--</span></div>
    <div class="tooltip-row"><span class="tooltip-label">Screen:</span> <span id="tip-screen">--</span></div>
    <div class="tooltip-row"><span class="tooltip-label">OS:</span> <span id="tip-os">--</span></div>
    <div class="tooltip-divider"></div>
    <div class="tooltip-row"><span class="tooltip-label">RAM Used:</span> <span id="tip-ram" class="text-green-400">--</span></div>
    <div class="tooltip-row"><span class="tooltip-label">Cookies:</span> <span id="tip-cookies" class="text-yellow-400">--</span></div>
    <div class="tooltip-row"><span class="tooltip-label">Size:</span> <span id="tip-size" class="text-cyan-400">--</span></div>
    <div class="tooltip-divider"></div>
    <div class="tooltip-row"><span class="tooltip-label">Visitors:</span> <span id="tip-visitors">--</span></div>
    <div class="tooltip-footer">Feeds on RAM & Cookies</div>
  </div>
</div>

<!-- Toggle Button -->
<button id="toggle-ambience" class="fixed right-4 top-20 z-50 p-2 bg-background/80 backdrop-blur-md border rounded-full shadow-lg hover:scale-110 transition-all group" title="Toggle Digital Ambience">
  <svg class="w-5 h-5 text-foreground group-hover:text-primary transition-colors" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
    <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
    <path d="M19 11h2m-1 -1v2" />
  </svg>
</button>

<!-- Neo's Screen - Exact Movie Recreation -->
<div id="matrix-container" class="fixed inset-0 z-[9999] pointer-events-none opacity-0">
  
  <!-- Phase 1: 1999 Browser Search - FULLSCREEN like the movie -->
  <div id="browser-phase" class="absolute inset-0 bg-[#4a5568]">
    <div class="browser-1999">
      <!-- 1999 Toolbar - Big square icons -->
      <div class="toolbar-1999">
        <div class="toolbar-icons-1999">
          <div class="icon-btn-1999">☰</div>
          <div class="icon-btn-1999">⊞</div>
          <div class="icon-btn-1999">▤</div>
          <div class="icon-btn-1999">◧</div>
          <div class="icon-btn-1999">▦</div>
          <div class="icon-btn-1999">◨</div>
          <div class="icon-btn-1999">▥</div>
        </div>
        <div class="download-btn-1999">Download</div>
      </div>
      
      <!-- Big Green Search Bar - Full Width -->
      <div class="searchbar-1999">
        <span class="search-label">Searching...</span>
      </div>
      
      <!-- Content: Newspaper + Dark Morpheus Silhouette -->
      <div class="content-1999">
        <div class="newspaper-1999" id="article-area">
          <!-- Articles cycle here -->
        </div>
        <div class="morpheus-area-1999">
          <div class="morpheus-silhouette-1999"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Phase 2: Black Screen with Messages -->
  <div id="terminal-phase" class="absolute inset-0 bg-black hidden">
    <div class="neo-message" id="neo-message"></div>
  </div>
</div>

<style>
  /* Minecraft color palette */
  :root {
    --wing-color-1: rgba(138, 180, 248, 0.7);
    --wing-color-2: rgba(100, 149, 237, 0.5);
    --wing-color-3: rgba(255, 255, 255, 0.8);
    --pixel-size: 6px;
  }
  
  /* Cloud Styles */
  .cloud {
    position: absolute;
    transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .cloud-1 { top: 0; left: 10px; animation-delay: 0s; }
  .cloud-2 { top: 90px; left: 25px; animation-delay: 0.3s; }
  .cloud-3 { top: 180px; left: 5px; animation-delay: 0.6s; }
  
  .cloud.visible {
    opacity: 1;
    transform: translateX(0) !important;
  }
  
  .cloud-glass {
    position: relative;
    padding: 12px 16px;
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.18);
    border-radius: 20px 20px 20px 5px;
    box-shadow: 
      0 8px 32px rgba(0,0,0,0.1),
      inset 0 1px 0 rgba(255,255,255,0.2);
    min-width: 120px;
  }
  
  .cloud-shape {
    position: absolute;
    top: -8px;
    left: 15px;
    width: 30px;
    height: 20px;
    background: inherit;
    border-radius: 50%;
    filter: blur(2px);
    opacity: 0.5;
  }
  
  .cloud-label {
    font-size: 8px;
    font-weight: 600;
    letter-spacing: 0.15em;
    color: var(--foreground);
    opacity: 0.5;
    margin-bottom: 2px;
  }
  
  .cloud-value {
    font-size: 18px;
    font-weight: 700;
    color: var(--foreground);
    line-height: 1.2;
  }
  
  .cloud-date {
    font-size: 9px;
    color: var(--foreground);
    opacity: 0.6;
    margin-top: 2px;
  }
  
  .cloud-status {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  
  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #22c55e;
    animation: pulse-status 2s ease-in-out infinite;
    box-shadow: 0 0 8px #22c55e;
  }
  
  @keyframes pulse-status {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.2); }
  }
  
  /* Cloud float animation */
  .cloud.visible {
    animation: cloud-float 6s ease-in-out infinite;
  }
  
  .cloud-1.visible { animation-delay: 0s; }
  .cloud-2.visible { animation-delay: 2s; }
  .cloud-3.visible { animation-delay: 4s; }
  
  @keyframes cloud-float {
    0%, 100% { transform: translateX(0) translateY(0); }
    25% { transform: translateX(5px) translateY(-3px); }
    50% { transform: translateX(0) translateY(-5px); }
    75% { transform: translateX(-3px) translateY(-2px); }
  }
  
  /* ===== MINECRAFT BUTTERFLY ===== */
  #minecraft-butterfly {
    transition: all 0.1s linear;
    image-rendering: pixelated;
    pointer-events: auto;
    cursor: pointer;
  }
  
  .mc-butterfly {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transform-style: preserve-3d;
    perspective: 200px;
  }
  
  /* Pixelated Body */
  .mc-body {
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 10;
    position: relative;
  }
  
  .body-pixel {
    width: var(--pixel-size);
    height: var(--pixel-size);
    background: #1a1a1a;
    box-shadow: 
      inset 1px 1px 0 rgba(255,255,255,0.2),
      inset -1px -1px 0 rgba(0,0,0,0.3);
  }
  
  .body-pixel.head {
    width: calc(var(--pixel-size) * 1.2);
    height: calc(var(--pixel-size) * 1.2);
    border-radius: 1px;
  }
  
  /* Pixelated Antennae */
  .mc-antenna {
    position: absolute;
    width: 2px;
    height: 10px;
    background: #1a1a1a;
    top: -8px;
  }
  
  .mc-antenna-left {
    left: -3px;
    transform: rotate(-30deg);
  }
  
  .mc-antenna-right {
    right: -3px;
    transform: rotate(30deg);
  }
  
  .mc-antenna::after {
    content: '';
    position: absolute;
    top: -3px;
    left: -1px;
    width: 4px;
    height: 4px;
    background: #1a1a1a;
  }
  
  /* Pixel Wings */
  .mc-wing {
    position: relative;
    transform-origin: center;
    transform-style: preserve-3d;
  }
  
  .mc-wing-left {
    transform-origin: right center;
    animation: mc-flap-left 0.3s ease-in-out infinite;
  }
  
  .mc-wing-right {
    transform-origin: left center;
    animation: mc-flap-right 0.3s ease-in-out infinite;
  }
  
  .wing-pixels {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
  }
  
  .mc-wing-right .wing-pixels {
    align-items: flex-start;
  }
  
  .pixel-row {
    display: flex;
  }
  
  .mc-wing-left .pixel-row {
    justify-content: flex-end;
  }
  
  .pixel {
    width: var(--pixel-size);
    height: var(--pixel-size);
    box-shadow: 
      inset 1px 1px 0 rgba(255,255,255,0.4),
      inset -1px -1px 0 rgba(0,0,0,0.2);
    image-rendering: pixelated;
  }
  
  /* Wing data overlay - glassmorphism on wings */
  .wing-data-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    opacity: 0;
    transition: opacity 0.2s;
    pointer-events: none;
  }
  
  .mc-data {
    font-size: 6px;
    font-family: 'Courier New', monospace;
    color: #fff;
    text-shadow: 1px 1px 0 #000;
    white-space: nowrap;
  }
  
  /* Minecraft-style flapping */
  @keyframes mc-flap-left {
    0%, 100% { transform: rotateY(0deg) rotateX(5deg); }
    50% { transform: rotateY(70deg) rotateX(-10deg); }
  }
  
  @keyframes mc-flap-right {
    0%, 100% { transform: rotateY(0deg) rotateX(5deg); }
    50% { transform: rotateY(-70deg) rotateX(-10deg); }
  }
  
  /* Tooltip - Minecraft style */
  .mc-tooltip {
    position: absolute;
    top: -80px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(16, 0, 16, 0.94);
    border: 2px solid #5c005c;
    padding: 6px 10px;
    font-family: 'Courier New', monospace;
    font-size: 10px;
    color: #fff;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
    pointer-events: none;
    box-shadow: 
      inset 0 0 0 1px rgba(255,255,255,0.1),
      0 4px 12px rgba(0,0,0,0.5);
  }
  
  .mc-tooltip::before {
    content: '';
    position: absolute;
    bottom: -6px;
    left: 50%;
    transform: translateX(-50%);
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid #5c005c;
  }
  
  #minecraft-butterfly:hover .mc-tooltip {
    opacity: 1;
  }
  
  .tooltip-row {
    display: flex;
    gap: 6px;
    line-height: 1.4;
  }
  
  .tooltip-label {
    color: #aaa;
  }
  
  /* Butterfly flying around the screen */
  #minecraft-butterfly {
    animation: mc-fly 20s ease-in-out infinite;
  }
  
  @keyframes mc-fly {
    0% { 
      bottom: 100px; 
      right: 100px; 
      transform: rotate(0deg);
    }
    10% { 
      bottom: 200px; 
      right: 150px; 
      transform: rotate(-5deg);
    }
    20% { 
      bottom: 300px; 
      right: 80px; 
      transform: rotate(8deg);
    }
    30% { 
      bottom: 250px; 
      right: 200px; 
      transform: rotate(-3deg);
    }
    40% { 
      bottom: 400px; 
      right: 120px; 
      transform: rotate(10deg);
    }
    50% { 
      bottom: 350px; 
      right: 250px; 
      transform: rotate(-8deg);
    }
    60% { 
      bottom: 200px; 
      right: 300px; 
      transform: rotate(5deg);
    }
    70% { 
      bottom: 150px; 
      right: 180px; 
      transform: rotate(-10deg);
    }
    80% { 
      bottom: 250px; 
      right: 50px; 
      transform: rotate(3deg);
    }
    90% { 
      bottom: 180px; 
      right: 120px; 
      transform: rotate(-5deg);
    }
    100% { 
      bottom: 100px; 
      right: 100px; 
      transform: rotate(0deg);
    }
  }
  
  /* Pause on hover */
  #minecraft-butterfly:hover {
    animation-play-state: paused;
  }
  
  #minecraft-butterfly:hover .mc-wing-left,
  #minecraft-butterfly:hover .mc-wing-right {
    animation-play-state: paused;
  }
  
  /* Hidden state */
  #clouds-container.hidden,
  #minecraft-butterfly.hidden {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.5s ease;
  }
  
  /* Responsive */
  @media (max-width: 768px) {
    #minecraft-butterfly {
      transform: scale(0.8);
    }
    
    #clouds-container {
      transform: scale(0.8);
      transform-origin: top left;
    }
  }
  
  @media (max-width: 480px) {
    #minecraft-butterfly {
      display: none;
    }
  }
  
  /* ===== NEO'S SCREEN - 1999 MOVIE EXACT STYLE ===== */
  #matrix-container.active {
    opacity: 1;
    pointer-events: auto;
  }
  
  /* 1999 Browser - Fullscreen */
  .browser-1999 {
    width: 100%;
    height: 100%;
    background: #c0c0c0;
    display: flex;
    flex-direction: column;
  }
  
  /* Big 1999 Toolbar with large square icons */
  .toolbar-1999 {
    background: linear-gradient(180deg, #d0d0d0 0%, #a8a8a8 100%);
    padding: 4px 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #808080;
    height: 44px;
  }
  
  .toolbar-icons-1999 {
    display: flex;
    gap: 2px;
  }
  
  .icon-btn-1999 {
    width: 36px;
    height: 34px;
    background: #c8c8c8;
    border: 2px outset #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: #333;
    font-weight: bold;
  }
  
  .download-btn-1999 {
    background: #c8c8c8;
    border: 2px outset #ffffff;
    padding: 6px 20px;
    font-family: Arial, sans-serif;
    font-size: 13px;
    font-weight: bold;
    color: #000;
  }
  
  /* Big Green Search Bar - FULL WIDTH like movie */
  .searchbar-1999 {
    background: #004d00;
    padding: 10px 20px;
    border: 3px inset #003300;
    margin: 0;
  }
  
  .search-label {
    color: #00ff00;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 18px;
    font-weight: bold;
    letter-spacing: 2px;
    text-shadow: 0 0 5px #00ff00;
  }
  
  /* Main Content Area */
  .content-1999 {
    flex: 1;
    display: flex;
    background: #d4d0c0;
    overflow: hidden;
  }
  
  /* Newspaper - Scanned/aged look */
  .newspaper-1999 {
    flex: 1;
    padding: 15px 20px;
    overflow: hidden;
    font-family: 'Times New Roman', Georgia, serif;
    color: #1a1a1a;
    background: #e8e4d8;
    background-image: 
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 1px,
        rgba(0,0,0,0.03) 1px,
        rgba(0,0,0,0.03) 2px
      );
  }
  
  /* Newspaper Headlines */
  .article-lang {
    font-size: 52px;
    font-weight: bold;
    text-align: center;
    margin: 0 0 5px 0;
    font-family: 'Times New Roman', serif;
    letter-spacing: 3px;
    border-bottom: 3px solid #000;
    padding-bottom: 5px;
  }
  
  .article-subtitle {
    font-size: 11px;
    text-align: center;
    margin-bottom: 10px;
    font-style: italic;
    color: #444;
  }
  
  .article-headline {
    font-size: 36px;
    font-weight: bold;
    font-family: 'Times New Roman', serif;
    margin: 12px 0 10px 0;
    line-height: 1.0;
    letter-spacing: -1px;
  }
  
  .article-text {
    font-size: 13px;
    line-height: 1.45;
    text-align: justify;
    column-count: 3;
    column-gap: 20px;
    column-rule: 1px solid #aaa;
  }
  
  .article-text p {
    margin-bottom: 8px;
    text-indent: 1.2em;
  }
  
  .article-text p:first-child {
    text-indent: 0;
  }
  
  .article-text p:first-child::first-letter {
    font-size: 2.8em;
    float: left;
    line-height: 0.85;
    margin-right: 6px;
    font-weight: bold;
  }
  
  /* Morpheus Silhouette - Dark grainy like surveillance photo */
  .morpheus-area-1999 {
    width: 260px;
    min-width: 260px;
    background: #0a0a0a;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding: 20px 15px;
    border-left: 2px solid #666;
  }
  
  .morpheus-silhouette-1999 {
    width: 220px;
    height: 320px;
    background: 
      radial-gradient(ellipse 80% 50% at 50% 25%, #1a1a1a 0%, #000 60%),
      radial-gradient(ellipse 60% 30% at 50% 75%, #111 0%, #000 50%);
    border-radius: 45% 45% 42% 42% / 35% 35% 25% 25%;
    position: relative;
    filter: blur(1px) contrast(1.5);
    opacity: 0.9;
  }
  
  /* Grainy noise effect */
  .morpheus-silhouette-1999::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.15;
    mix-blend-mode: overlay;
  }
  
  /* Phase 2: Terminal Messages */
  #terminal-phase {
    display: flex;
    align-items: flex-start;
    justify-content: flex-start;
    padding: 12% 8%;
  }
  
  #terminal-phase.hidden {
    display: none;
  }
  
  .neo-message {
    font-family: 'Courier New', 'Lucida Console', monospace;
    font-size: 28px;
    color: #00ff41;
    letter-spacing: 2px;
    text-shadow: 0 0 10px #00ff41, 0 0 20px #00aa30;
    white-space: pre-wrap;
    line-height: 2.2;
  }
  
  @media (max-width: 900px) {
    .morpheus-area-1999 {
      width: 180px;
      min-width: 180px;
    }
    .morpheus-silhouette-1999 {
      width: 150px;
      height: 220px;
    }
    .article-text {
      column-count: 2;
    }
    .article-lang {
      font-size: 40px;
    }
    .article-headline {
      font-size: 28px;
    }
  }
  
  @media (max-width: 600px) {
    .morpheus-area-1999 {
      display: none;
    }
    .article-text {
      column-count: 1;
    }
    .article-lang {
      font-size: 32px;
    }
    #terminal-phase {
      padding: 8% 5%;
    }
    .neo-message {
      font-size: 20px;
    }
  }
  
  /* Butterfly color transition based on position */
  #minecraft-butterfly {
    --hue: 210;
    filter: hue-rotate(calc(var(--hue) * 1deg));
    transition: filter 0.5s ease, transform 0.3s ease;
  }
  
  /* Butterfly breathing/pulsing based on size */
  @keyframes butterfly-breathe {
    0%, 100% { transform: scale(var(--butterfly-scale, 1)); }
    50% { transform: scale(calc(var(--butterfly-scale, 1) * 1.05)); }
  }
  
  .mc-butterfly {
    animation: butterfly-breathe 2s ease-in-out infinite;
  }
  
  /* Tooltip enhancements */
  .tooltip-header {
    font-size: 11px;
    font-weight: bold;
    color: #fff;
    text-align: center;
    margin-bottom: 4px;
    padding-bottom: 4px;
    border-bottom: 1px solid #5c005c;
  }
  
  .tooltip-divider {
    height: 1px;
    background: #5c005c;
    margin: 4px 0;
  }
  
  .tooltip-footer {
    font-size: 8px;
    color: #888;
    text-align: center;
    margin-top: 4px;
    font-style: italic;
  }
  
  .text-green-400 { color: #4ade80; }
  .text-yellow-400 { color: #facc15; }
  .text-cyan-400 { color: #22d3ee; }
</style>

<script>
  document.addEventListener('astro:page-load', () => {
    const cloudsContainer = document.getElementById('clouds-container')
    const butterflyEl = document.getElementById('minecraft-butterfly')
    const toggleBtn = document.getElementById('toggle-ambience')
    
    // Neo's screen elements
    const matrixContainer = document.getElementById('matrix-container')
    const browserPhase = document.getElementById('browser-phase')
    const terminalPhase = document.getElementById('terminal-phase')
    const articleArea = document.getElementById('article-area')
    const neoMessage = document.getElementById('neo-message')
    
    // Cloud elements
    const utcTime = document.getElementById('utc-time')
    const utcDate = document.getElementById('utc-date')
    const localTime = document.getElementById('local-time')
    const localZone = document.getElementById('local-zone')
    const uptime = document.getElementById('uptime')
    
    // Butterfly tooltip elements
    const tipBrowser = document.getElementById('tip-browser')
    const tipScreen = document.getElementById('tip-screen')
    const tipOs = document.getElementById('tip-os')
    const tipVisitors = document.getElementById('tip-visitors')
    const tipRam = document.getElementById('tip-ram')
    const tipCookies = document.getElementById('tip-cookies')
    const tipSize = document.getElementById('tip-size')
    
    // Butterfly wing data
    const mcBrowser = document.getElementById('mc-browser')
    const mcScreen = document.getElementById('mc-screen')
    const mcOs = document.getElementById('mc-os')
    const mcVisitors = document.getElementById('mc-visitors')
    
    if (!cloudsContainer || !butterflyEl) return
    
    let sessionStart = Date.now()
    let isVisible = localStorage.getItem('hideAmbience') !== 'true'
    let idleTimer: number | null = null
    let matrixActive = false
    let lastActivityTime = Date.now()
    const IDLE_TIMEOUT = 11000 // 11 seconds
    
    // Butterfly state
    let butterflyHue = 210
    let butterflyScale = 1
    let ramUsed = 0
    let cookieCount = 0
    
    // Initialize visibility
    if (!isVisible) {
      cloudsContainer.classList.add('hidden')
      butterflyEl.classList.add('hidden')
    }
    
    // ===== NEO'S SCREEN - CINEMATIC MOVIE STYLE =====
    
    // News articles in multiple languages (like the movie)
    const articles = [
      {
        lang: 'النهار',
        langSub: 'AN-NAHAR',
        subtitle: 'Published every Tuesday and Thursday\nALL STATES $1.50',
        headline: 'TERRORIST LEADER',
        text: `London: As the search intensifies for the notorious terrorist leader, 'Morpheus' a sighting has just been reported to this newspaper by British Intelligence.

The terrorist leader has been seen in world regions with most recent sightings in the British Isles. One leading British agent, a specialist in terrorist activity, compiled data on terrorist activities forming substantial evidence.`
      },
      {
        lang: '新闻报',
        langSub: 'XINWEN BAO',
        subtitle: 'China Daily News\nBeijing Edition',
        headline: 'MANHUNT CONTINUES',
        text: `Beijing: International authorities have expanded their search for the elusive figure known only as 'Morpheus'. Intelligence agencies from twelve nations are now cooperating in what has become the largest cyber-terrorism investigation in history.

Sources indicate the suspect has accessed classified military systems across multiple continents.`
      },
      {
        lang: '朝日新聞',
        langSub: 'ASAHI SHIMBUN',
        subtitle: 'Tokyo Morning Edition',
        headline: 'GLOBAL ALERT',
        text: `Tokyo: Japanese intelligence officials have confirmed suspicious network activity linked to the international fugitive. The National Police Agency has issued alerts to all major infrastructure facilities.

"This individual represents a threat unlike anything we have encountered," stated a senior official who spoke on condition of anonymity.`
      },
      {
        lang: 'LE MONDE',
        langSub: 'LE MONDE',
        subtitle: 'Paris, France',
        headline: 'INTERPOL BULLETIN',
        text: `Paris: INTERPOL has raised the threat level to maximum following new intelligence suggesting imminent action by the terrorist network. European capitals are on high alert.

French intelligence services are coordinating with American agencies to track digital footprints left across government systems worldwide.`
      },
      {
        lang: 'DER SPIEGEL',
        langSub: 'DER SPIEGEL',
        subtitle: 'Hamburg, Deutschland',
        headline: 'CYBER THREAT',
        text: `Hamburg: German federal authorities have detected intrusion attempts on critical infrastructure systems believed to be connected to the Morpheus network.

BND officials warn that conventional security measures are inadequate against this new form of technological terrorism.`
      },
      {
        lang: 'AIRPORT',
        langSub: '',
        subtitle: '',
        headline: 'HEATHROW AIRPORT',
        text: `London: As the search intensifies for the notorious terrorist leader, 'Morpheus' a sighting has just been reported to this newspaper by British Intelligence.

One local policeman was also present at Heathrow Airport for comments. "I have been working closely with intelligence in the pursuit of this terrorist. We cannot state clearly this person's physical and cultural attributes but we can say that leading espionage communities are moving closer to establishing the truth behind the terrorist's identity."`
      }
    ]
    
    // Final messages - exact movie timing
    const neoMessages = [
      'Wake up, Neo...',
      'The Matrix has you...',
      'Follow the white rabbit.',
      'Knock, knock, Neo.'
    ]
    
    let screenTimeout: number | null = null
    let articleIndex = 0
    let messageIndex = 0
    let charIndex = 0
    let currentPhase: 'browser' | 'transition' | 'terminal' = 'browser'
    
    // Show article in browser
    const showArticle = () => {
      if (!matrixActive || !articleArea) return
      
      const article = articles[articleIndex]
      
      articleArea.innerHTML = `
        <div class="article-lang">${article.lang}</div>
        ${article.langSub ? `<div class="article-subtitle">${article.langSub}${article.subtitle ? '<br>' + article.subtitle.replace(/\n/g, '<br>') : ''}</div>` : ''}
        <div class="article-headline">${article.headline}</div>
        <div class="article-text">${article.text.split('\n\n').map(p => `<p>${p}</p>`).join('')}</div>
      `
      
      articleIndex++
      
      if (articleIndex < articles.length) {
        // Show next article after delay
        screenTimeout = window.setTimeout(showArticle, 1800)
      } else {
        // All articles shown, transition to terminal
        screenTimeout = window.setTimeout(startTerminalPhase, 2000)
      }
    }
    
    // Transition to black screen with messages
    const startTerminalPhase = () => {
      if (!matrixActive) return
      
      currentPhase = 'terminal'
      browserPhase?.classList.add('hidden')
      terminalPhase?.classList.remove('hidden')
      
      messageIndex = 0
      charIndex = 0
      if (neoMessage) neoMessage.textContent = ''
      
      // Start typing after pause
      screenTimeout = window.setTimeout(typeMessage, 1000)
    }
    
    // Type message character by character - ONE message at a time, cinematic style
    const typeMessage = () => {
      if (!matrixActive || !neoMessage) return
      
      if (messageIndex < neoMessages.length) {
        const msg = neoMessages[messageIndex]
        
        if (charIndex < msg.length) {
          // Type one character
          neoMessage.textContent += msg[charIndex]
          charIndex++
          // Slow typing like in movie
          screenTimeout = window.setTimeout(typeMessage, 100 + Math.random() * 50)
        } else {
          // Message complete - wait, then clear and show next
          messageIndex++
          charIndex = 0
          
          if (messageIndex < neoMessages.length) {
            // Wait 3 seconds, then clear screen and type next message
            screenTimeout = window.setTimeout(() => {
              if (!matrixActive) return
              neoMessage.textContent = '' // Clear the screen
              screenTimeout = window.setTimeout(typeMessage, 800) // Brief pause before next message
            }, 3000)
          }
          // If last message, just leave it on screen
        }
      }
    }
    
    const startNeoScreen = () => {
      if (matrixActive) return
      matrixActive = true
      currentPhase = 'browser'
      articleIndex = 0
      messageIndex = 0
      charIndex = 0
      
      // Reset UI
      browserPhase?.classList.remove('hidden')
      terminalPhase?.classList.add('hidden')
      if (neoMessage) neoMessage.textContent = ''
      
      matrixContainer?.classList.add('active')
      
      // Start showing articles
      screenTimeout = window.setTimeout(showArticle, 500)
    }
    
    const stopNeoScreen = () => {
      matrixActive = false
      
      if (screenTimeout) {
        clearTimeout(screenTimeout)
        screenTimeout = null
      }
      
      matrixContainer?.classList.remove('active')
      browserPhase?.classList.remove('hidden')
      terminalPhase?.classList.add('hidden')
      
      if (neoMessage) neoMessage.textContent = ''
      if (articleArea) articleArea.innerHTML = ''
      
      resetIdleTimer()
    }
    
    // Exit on click or ESC
    matrixContainer?.addEventListener('click', stopNeoScreen)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && matrixActive) {
        stopNeoScreen()
      }
    })
    
    // Idle detection
    const resetIdleTimer = () => {
      lastActivityTime = Date.now()
      if (idleTimer) {
        clearTimeout(idleTimer)
      }
      if (!matrixActive) {
        idleTimer = window.setTimeout(() => {
          startNeoScreen()
        }, IDLE_TIMEOUT)
      }
    }
    
    // Activity listeners
    const activityEvents = ['mousedown', 'mousemove', 'keydown', 'scroll', 'touchstart', 'click']
    activityEvents.forEach(event => {
      document.addEventListener(event, () => {
        if (!matrixActive) {
          resetIdleTimer()
        }
      }, { passive: true })
    })
    
    // ===== BUTTERFLY FEEDING ON RAM & COOKIES =====
    const updateButterflySize = () => {
      // Get RAM usage (if available)
      const perf = (performance as any)
      if (perf.memory) {
        ramUsed = Math.round(perf.memory.usedJSHeapSize / (1024 * 1024))
      } else {
        // Estimate based on DOM size
        ramUsed = Math.round(document.documentElement.outerHTML.length / 1024)
      }
      
      // Count cookies
      cookieCount = document.cookie ? document.cookie.split(';').length : 0
      
      // Calculate butterfly scale based on RAM + cookies
      // More RAM/cookies = bigger butterfly (feeds on them)
      const ramFactor = Math.min(ramUsed / 50, 2) // Max 2x from RAM
      const cookieFactor = Math.min(cookieCount / 5, 1) // Max 1x from cookies
      butterflyScale = 0.8 + (ramFactor * 0.3) + (cookieFactor * 0.2)
      butterflyScale = Math.min(butterflyScale, 2) // Cap at 2x
      
      // Apply scale
      butterflyEl.style.setProperty('--butterfly-scale', butterflyScale.toString())
      
      // Update tooltip
      if (tipRam) tipRam.textContent = `${ramUsed}MB`
      if (tipCookies) tipCookies.textContent = `${cookieCount} cookies`
      if (tipSize) tipSize.textContent = `${Math.round(butterflyScale * 100)}%`
    }
    
    // ===== BUTTERFLY COLOR CHANGE ON MOVEMENT =====
    let lastButterflyPos = { x: 0, y: 0 }
    
    const updateButterflyColor = () => {
      const rect = butterflyEl.getBoundingClientRect()
      const x = rect.left
      const y = rect.top
      
      // Calculate hue based on position (0-360)
      const screenDiagonal = Math.sqrt(window.innerWidth ** 2 + window.innerHeight ** 2)
      const posDiagonal = Math.sqrt(x ** 2 + y ** 2)
      butterflyHue = (posDiagonal / screenDiagonal) * 360
      
      // Apply hue rotation
      butterflyEl.style.setProperty('--hue', butterflyHue.toString())
      
      lastButterflyPos = { x, y }
    }
    
    // Track butterfly position and update color
    const butterflyColorInterval = setInterval(updateButterflyColor, 100)
    
    // Toggle handler
    toggleBtn?.addEventListener('click', () => {
      isVisible = !isVisible
      localStorage.setItem('hideAmbience', (!isVisible).toString())
      
      if (isVisible) {
        cloudsContainer.classList.remove('hidden')
        butterflyEl.classList.remove('hidden')
        showClouds()
      } else {
        cloudsContainer.classList.add('hidden')
        butterflyEl.classList.add('hidden')
      }
    })
    
    // Show clouds with delay
    const showClouds = () => {
      const clouds = document.querySelectorAll('.cloud')
      clouds.forEach((cloud, i) => {
        setTimeout(() => {
          cloud.classList.add('visible')
        }, i * 200 + 500)
      })
    }
    
    // Update time displays
    const updateTime = () => {
      const now = new Date()
      
      // UTC Time
      if (utcTime) {
        utcTime.textContent = now.toUTCString().split(' ')[4]
      }
      if (utcDate) {
        utcDate.textContent = now.toISOString().split('T')[0]
      }
      
      // Local Time
      if (localTime) {
        localTime.textContent = now.toLocaleTimeString('en-US', { 
          hour12: false,
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        })
      }
      if (localZone) {
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone
        localZone.textContent = tz.replace('_', ' ')
      }
      
      // Uptime
      if (uptime) {
        const elapsed = Math.floor((Date.now() - sessionStart) / 1000)
        const mins = Math.floor(elapsed / 60)
        const secs = elapsed % 60
        uptime.textContent = mins > 0 ? `Session: ${mins}m ${secs}s` : `Session: ${secs}s`
      }
    }
    
    // Get browser info
    const getBrowserInfo = () => {
      const ua = navigator.userAgent
      let browser = 'Unknown'
      let version = ''
      
      if (ua.includes('Firefox/')) {
        browser = 'Firefox'
        version = ua.split('Firefox/')[1]?.split(' ')[0] || ''
      } else if (ua.includes('Chrome/') && !ua.includes('Edg/')) {
        browser = 'Chrome'
        version = ua.split('Chrome/')[1]?.split(' ')[0] || ''
      } else if (ua.includes('Safari/') && !ua.includes('Chrome/')) {
        browser = 'Safari'
        version = ua.split('Version/')[1]?.split(' ')[0] || ''
      } else if (ua.includes('Edg/')) {
        browser = 'Edge'
        version = ua.split('Edg/')[1]?.split(' ')[0] || ''
      } else if (ua.includes('Opera/') || ua.includes('OPR/')) {
        browser = 'Opera'
        version = ua.split('OPR/')[1]?.split(' ')[0] || ''
      }
      
      const browserText = `${browser} ${version.split('.')[0]}`
      if (tipBrowser) tipBrowser.textContent = browserText
      if (mcBrowser) mcBrowser.textContent = browser
      
      return browserText
    }
    
    // Get screen info
    const getScreenInfo = () => {
      const screenText = `${window.innerWidth}x${window.innerHeight}`
      if (tipScreen) tipScreen.textContent = screenText
      if (mcScreen) mcScreen.textContent = screenText
      
      return screenText
    }
    
    // Get OS info
    const getOSInfo = () => {
      const ua = navigator.userAgent
      let os = 'Unknown'
      let device = 'Desktop'
      
      if (ua.includes('Windows')) os = 'Windows'
      else if (ua.includes('Mac')) os = 'macOS'
      else if (ua.includes('Linux') && !ua.includes('Android')) os = 'Linux'
      else if (ua.includes('Android')) { os = 'Android'; device = 'Mobile' }
      else if (ua.includes('iPhone') || ua.includes('iPad')) { 
        os = 'iOS'
        device = ua.includes('iPad') ? 'Tablet' : 'Mobile'
      }
      
      const osText = `${os} (${device})`
      if (tipOs) tipOs.textContent = osText
      if (mcOs) mcOs.textContent = os
      
      return osText
    }
    
    // Get visitor count
    const getVisitorCount = () => {
      const key = 'site_visitors_ambience'
      let count = parseInt(localStorage.getItem(key) || '0')
      const sessionKey = 'session_ambience'
      
      if (!sessionStorage.getItem(sessionKey)) {
        count++
        localStorage.setItem(key, count.toString())
        sessionStorage.setItem(sessionKey, '1')
      }
      
      const visitorCount = count + 389
      if (tipVisitors) tipVisitors.textContent = visitorCount.toString()
      if (mcVisitors) mcVisitors.textContent = visitorCount.toString()
      
      return visitorCount
    }
    
    // Update screen size on resize
    window.addEventListener('resize', getScreenInfo)
    
    // Initialize
    if (isVisible) {
      showClouds()
    }
    
    getBrowserInfo()
    getScreenInfo()
    getOSInfo()
    getVisitorCount()
    updateButterflySize()
    updateTime()
    
    // Start idle timer
    resetIdleTimer()
    
    // Update time every second
    setInterval(updateTime, 1000)
    
    // Update butterfly size periodically (feeding)
    setInterval(updateButterflySize, 5000)
  })
</script>
